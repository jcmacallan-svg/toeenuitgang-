<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>VEVA â€“ Ingang/Uitgang Trainer</title>
  <link rel="stylesheet" href="styles.css" />
<link rel="icon" href="data:image/svg+xml;charset=utf-8,<svg xmlns=%27http://www.w3.org/2000/svg%27 width=%2764%27 height=%2764%27> <rect width=%27100%%27 height=%27100%%27 fill=%27%231b2a44%27/> <circle cx=%2732%27 cy=%2726%27 r=%2714%27 fill=%27%237aa2d6%27/> <rect x=%2714%27 y=%2742%27 width=%2736%27 height=%2718%27 rx=%279%27 fill=%27%237aa2d6%27/> </svg>">
</head>
<body>
  <main class="wrap">
    <header class="topbar">
      <div class="brand">
        <div class="logo">VEVA</div>
        <div>
          <div class="title">VEVA â€“ Ingang/Uitgang Trainer</div>
          </div>
      </div>
      <div class="meta" id="meta"></div>
    <button class="btn subtle" id="btnTeacher" title="Teacher mode">Docent</button>
</header>

    <!-- Screen 1: Name -->
    <section class="card" id="screen-login">
      <h1>Start</h1>
      <p class="muted">Vul je naam in. Daarna start de oefening.</p>

      <div class="grid2" id="trainGrid">
        <label class="field">
          <span>Naam leerling</span>
          <input id="studentName" autocomplete="name" placeholder="Bijv. Lisa" />
        </label>
        <label class="field">
          <span>Groep (optioneel)</span>
          <select id="className">
            <option value="">â€” kies â€”</option>
            <option value="Alpha">Alpha</option>
            <option value="Bravo">Bravo</option>
            <option value="Charlie">Charlie</option>
            <option value="Delta">Delta</option>
          </select>
        </label>
      </div>

      <label class="field">
        <span>Niveau</span>
        <select id="difficulty">
          <option value="Basic">Basic</option>
          <option value="Standard" selected>Standard</option>
          <option value="Advanced">Advanced</option>
        </select>
      </label>

      <div class="row">
        <button class="btn primary" id="btnStart">Start oefening</button>
        <button class="btn" id="btnResetLocal" title="Verwijdert alleen lokaal opgeslagen data">Reset lokaal</button>
      </div>

      <details class="details">
        <div class="detailsBody">
          <p>GitHub Pages is statisch. Wil je centraal kunnen zien wie geoefend heeft en hoe vaak, dan heb je een extern logpunt nodig (bijv. Google Sheet via Apps Script of Supabase/Firebase).</p>
          <p>In deze versie kun je:</p>
          <ul>
            <li><b>Zonder backend</b>: alleen lokaal (op het apparaat) bijhouden.</li>
            <li><b>Met backend</b>: stel in <code>config.js</code> een endpoint in om starts/finishes te loggen.</li>
          </ul>
        </div>
      </details>
    </section>

    <!-- Screen 2: Training -->
    <section class="card hidden" id="screen-train">
      <div class="trainHead">
        <div>
          <div class="stepTitle" id="stepTitle"></div>
          <div class="muted" id="stepHelp"></div>
        </div>
        <div class="trainBtns">
          <button class="btn" id="btnHint">Hint</button>
          <button class="btn primary" id="btnDoneStep">I'm done with this step</button>
        </div>
      </div>

      <div class="gridTrain">
        <div class="panel">
          <div class="panelTitle">Visitor answer (shown briefly)</div>
          <div class="visitorRow">
          <img id="visitorAvatar" class="visitorAvatar" alt="visitor" />
          <div class="visitorCol">
            <div class="bubble" id="visitorBubble">Ask your first questionâ€¦</div>
            <div id="visitorMood" class="visitorMood muted"></div>
          </div>
        </div>

          
        <div class="studentRow">
          <img id="studentAvatar" class="studentAvatar" alt="student" src="assets/photos/soldier.png" />
          <div class="studentCol">
            <div class="bubble me" id="studentBubble" style="display:none;"></div>
          </div>
        </div>

        <div class="panelTitle mt">Your question</div>
          <div class="row">
            <input id="studentInput" placeholder="Type your question in Englishâ€¦" />
            <button class="btn primary" id="btnSend">Send</button>
<button class="btn" id="btnMicHold" type="button" title="Hold to talk">ðŸŽ™ Hold to talk</button>
<span class="micStatus" id="micStatus" aria-live="polite"></span>
          </div>
          <div class="row actionBar">
            <button class="btn" id="btnContactSupervisor" title="Open supervisor 5W briefing (Step 2)">Contact supervisor</button>
            <button class="btn" id="btnReturnVisitor" title="Return to visitor after supervisor response">Return to visitor</button>
            <button class="btn" id="btnGoPersonSearch" title="Proceed to person search / pat-down">Go to person search</button>
            <button class="btn danger" id="btnDenyEntrance" title="Deny entrance at any time">Deny entrance</button>
          </div>

          <div class="muted small">Tip: schrijf de antwoorden in je eigen boekje.</div>

          <div class="divider"></div>
          <div class="row">
            <button class="btn" id="btnNewScenario">New scenario</button>
            <button class="btn" id="btnFinishRun">Finish run</button>
          </div>
        </div>

        <div class="panel" id="idPanel">
          <div class="panelTitle">ID Card</div>
          <canvas id="idCanvas" width="900" height="560" class="idCanvas"></canvas>
          
        </div>
      </div>
    </section>

    <!-- Screen 3: Feedback -->
    <section class="card hidden" id="screen-feedback">
      <h1>Feedback</h1>
      <p class="muted">Hier staan je grootste 3 missers en wat je volgende keer kunt vragen.</p>

      <div class="feedbackBox">
        <h2>Biggest 3 misses</h2>
        <ul id="top3"></ul>
      </div>

      <details class="details" open>
        <summary>All missed items</summary>
        <div class="detailsBody" id="allMisses"></div>
      </details>

      <div class="row">
        <button class="btn" id="btnBackToStart">Back to start</button>
        <button class="btn primary" id="btnDownloadCsv">Download CSV</button>
      </div>
    </section>

    <footer class="footer">
      <span class="muted small">Hosted on GitHub Pages (static). No TTS/voice. For central tracking: configure an external endpoint in <code>config.js</code>.</span>
    </footer>
  
    <!-- Supervisor modal (5W briefing) -->
    <div class="modal hidden" id="supervisorModal" role="dialog" aria-modal="true">
      <div class="modalCard">
        <div class="modalHead">
          <div class="modalTitle">Supervisor call (5W briefing)</div>
          <button class="btn" id="btnCloseModal">Close</button>
        </div>
        <p class="muted small">Fill in the 5W briefing (can be in Dutch). Then send to supervisor.</p>

        <div class="grid2">
          <label class="field"><span>Who are you?</span><input id="wWho" placeholder="Naam bezoeker" /></label>
          <label class="field"><span>What are you doing here?</span><input id="wWhat" placeholder="Doel (delivery/inspection/etc.)" /></label>
          <label class="field"><span>With whom is the meeting?</span><input id="wWithWhom" placeholder="Host / contactpersoon" /></label>
          <label class="field"><span>What time is the meeting?</span><input id="wTime" placeholder="Bijv. 10:30" /></label>
          <label class="field"><span>Why is the meeting?</span><input id="wWhy" placeholder="Onderwerp / reden" /></label>
        </div>

        <div class="row">
          <button class="btn primary" id="btnSendSupervisor">Send to supervisor</button>
<button class="btn primary" id="btnBackToVisitor" type="button">Return to visitor</button>
        </div>

        <div class="divider"></div>
        <div class="muted small" id="supervisorResponse"></div>
      </div>
    </div>


    <!-- Teacher Mode (hidden phrasebank editor) -->
    <div class="modal hidden" id="teacherModal" role="dialog" aria-modal="true">
      <div class="modalCard">
        <div class="modalHead">
          <div class="modalTitle">Teacher mode â€” Phrasebank editor</div>
          <div class="row">
            <button class="btn" id="btnTeacherClose">Close</button>
          </div>
        </div>

        <p class="muted small">
          This editor is hidden. Open with <b>Ctrl+Shift+T</b>. Changes are kept as a local draft and exported as <code>phrasebank.json</code>.
          Students will not see this unless teacher mode is opened.
        </p>

        <details class="details" id="teacherUnlockBox">
          <summary>Optional PIN unlock</summary>
          <div class="detailsBody">
            <p class="muted small">If you set <code>teacherPin</code> in <code>config.js</code>, you must enter it to edit.</p>
            <div class="row">
              <input id="teacherPinInput" placeholder="PIN" type="password" />
              <button class="btn primary" id="btnTeacherUnlock">Unlock</button>
              <span class="muted small" id="teacherUnlockStatus"></span>
            </div>
          </div>
        </details>

        <div class="tabs">
          <button class="tab active" data-tab="tab-intents">Intents (question patterns)</button>
          <button class="tab" data-tab="tab-smalltalk">Smalltalk (Q â†’ A)</button>
          <button class="tab" data-tab="tab-export">Import / Export</button>
        </div>

        <div class="tabPanel" id="tab-intents">
          <div class="grid2">
            <label class="field">
              <span>Intent</span>
              <select id="intentSelect"></select>
            </label>

            <label class="field">
              <span>New pattern</span>
              <input id="intentNewPattern" placeholder="e.g. what time is that delivery" />
            </label>
          </div>

          <div class="row">
            <button class="btn primary" id="btnAddIntentPattern">Add pattern</button>
            <button class="btn" id="btnDeleteIntentPattern">Delete selected</button>
            <span class="muted small" id="intentStatus"></span>
          </div>

          <div class="divider"></div>
          <div class="panel" style="max-height:240px; overflow:auto;">
            <div class="panelTitle">Patterns for selected intent</div>
            <select id="intentPatternList" size="8" style="width:100%; margin-top:8px;"></select>
          </div>
        </div>

        <div class="tabPanel hidden" id="tab-smalltalk">
          <div class="grid2">
            <label class="field">
              <span>New smalltalk name</span>
              <input id="stName" placeholder="e.g. how_are_you" />
            </label>
            <label class="field">
              <span>Response</span>
              <input id="stResponse" placeholder="e.g. I'm good, thank you." />
            </label>
          </div>
          <label class="field">
            <span>Patterns (comma separated)</span>
            <input id="stPatterns" placeholder="e.g. how are you, how're you, how are u" />
          </label>
          <div class="row">
            <button class="btn primary" id="btnAddSmalltalk">Add smalltalk</button>
            <button class="btn" id="btnDeleteSmalltalk">Delete selected</button>
            <span class="muted small" id="smalltalkStatus"></span>
          </div>

          <div class="divider"></div>
          <div class="panel" style="max-height:240px; overflow:auto;">
            <div class="panelTitle">Smalltalk entries</div>
            <select id="smalltalkList" size="8" style="width:100%; margin-top:8px;"></select>
          </div>
        </div>

        <div class="tabPanel hidden" id="tab-export">
          <div class="row">
            <button class="btn primary" id="btnExportPhrasebank">Download phrasebank.json</button>
            <button class="btn" id="btnUseDraftNow">Use draft for recognition (this browser)</button>
            <button class="btn" id="btnDiscardDraft">Discard local draft</button>
          </div>

          <div class="divider"></div>

          <label class="field">
            <span>Import phrasebank.json</span>
            <input type="file" id="phrasebankFile" accept="application/json" />
          </label>
          <div class="row">
            <button class="btn" id="btnImportPhrasebank">Import</button>
            <span class="muted small" id="exportStatus"></span>
          </div>

          <details class="details">
            <summary>How to apply changes for everyone</summary>
            <div class="detailsBody">
              <ol>
                <li>Use this editor to add patterns/questions.</li>
                <li>Click <b>Download phrasebank.json</b>.</li>
                <li>Replace the repo file <code>phrasebank.json</code> with the downloaded one.</li>
                <li>Commit + push to GitHub (Pages updates).</li>
              </ol>
            </div>
          </details>
        </div>
      </div>
    </div>

</main>

  <script src="config.js"></script>
  <<script src="app.js?v=48"></script>
</body>
</html>
